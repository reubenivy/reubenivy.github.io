<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Reuben & Ivy</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@200;400;500&display=swap"
    />
    <style>
      body {
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: "Fira Sans", sans-serif;
        background: #ffcc00;
        color: #000;
      }

      #login-box {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem;
        border-radius: 8px;
      }

      input {
        padding: 12px 16px;
        font-size: 1.2em; /* >=16px triggers mobile zoom */
        border-radius: 6px;
        border: 2px solid #000;
        margin-bottom: 1rem;
        text-align: center;
        outline: none;
        font-weight: bold;
      }

      button {
        padding: 12px 24px;
        font-size: 1em;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        background: #3498db;
        color: #fff;
        font-weight: bold;
        transition: background 0.3s ease, transform 0.2s ease;
      }

      button:hover {
        background: #5dade2;
        transform: scale(1.05);
      }
    </style>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
  </head>
  <body>
    <div id="login-box">
      <h2>Enter Password</h2>
      <input type="password" id="pw-input" placeholder="Password" autofocus />
      <button id="pw-btn">Submit</button>
    </div>

    <script>
      const correctHash =
        "3dedbfa834f36bfb30ce5a9a5bca8ceb7fe48d8e38ec21d6903a5c464a43cae8";

      async function hashPassword(pwd) {
        const enc = new TextEncoder().encode(pwd);
        const buf = await crypto.subtle.digest("SHA-256", enc);
        return Array.from(new Uint8Array(buf))
          .map((b) => b.toString(16).padStart(2, "0"))
          .join("");
      }

      async function checkPassword() {
        const val = document.getElementById("pw-input").value;
        const hash = await hashPassword(val);

        if (hash === correctHash) {
          sessionStorage.setItem("authenticated", "true"); // session-only
          window.location.href = "timeline.html"; // redirect
        } else {
          alert("Wrong password!");
          // clear input and refocus
          const input = document.getElementById("pw-input");
          input.value = "";
          setTimeout(() => input.focus(), 50);
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        const input = document.getElementById("pw-input");

        // small delay ensures focus works even after redirect
        setTimeout(() => input?.focus(), 100);

        document
          .getElementById("pw-btn")
          .addEventListener("click", checkPassword);
        input.addEventListener("keydown", (e) => {
          if (e.key === "Enter") checkPassword();
        });
      });
    </script>
  </body>
</html>
